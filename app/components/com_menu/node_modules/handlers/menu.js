var NE = require('nuby-express');
var Path_Handler = NE.Path_Handler;
var Menu = require('Menu');
var util = require('util');
var _DEBUG = false;

module.exports = function () {

    return new Path_Handler({
        name:'menu_path_handler',
        type:'file',
        re:/(.*)?(_)?menu.js$/,
        execute:function (props, callback) {
           if (_DEBUG) console.log('loading menu %s', props.full_path);
            try {

                var def = require(props.full_path);
                if (_DEBUG) console.log('lading menu %s', util.inspect(def));
                props.frame.add_resource(new Menu(def));
                callback();
            } catch(err){
                console.log('error: %s', err.message);
                callback();
            }
        }
    });

}